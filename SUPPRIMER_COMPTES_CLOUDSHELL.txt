============================================================
M√âTHODE LA PLUS SIMPLE : AWS CloudShell
============================================================

√âTAPE 1 : Ouvrir CloudShell
----------------------------
1. En haut de l'√©cran AWS Console, cherchez l'ic√¥ne "CloudShell" (‚òÅÔ∏è avec >_)
2. OU allez sur : https://console.aws.amazon.com/cloudshell/home
3. Cliquez sur CloudShell

‚è±Ô∏è Premi√®re fois : Attendez 30-60 secondes que CloudShell d√©marre


√âTAPE 2 : Installer psql
------------------------
Dans CloudShell, tapez :

sudo yum install -y postgresql15

(Appuyez sur Entr√©e, attendez la fin de l'installation)


√âTAPE 3 : Se connecter √† la base
---------------------------------
Tapez cette commande (REMPLACEZ le mot de passe) :

PGPASSWORD='VOTRE_MOT_DE_PASSE_RDS' psql -h mapevent-db.cr0mmuc0elm6.eu-west-1.rds.amazonaws.com -U postgres -d postgres

Exemple :
PGPASSWORD='MonMotDePasse123!' psql -h mapevent-db.cr0mmuc0elm6.eu-west-1.rds.amazonaws.com -U postgres -d postgres

(Appuyez sur Entr√©e)


√âTAPE 4 : Voir tous vos comptes
--------------------------------
Une fois connect√©, tapez :

SELECT id, email, username, COALESCE(role, 'user') as role, created_at FROM users ORDER BY created_at DESC;

(Appuyez sur Entr√©e)

üìù NOTEZ L'EMAIL de votre compte admin (celui que vous voulez garder)


√âTAPE 5 : Supprimer tous les comptes SAUF l'admin
--------------------------------------------------
‚ö†Ô∏è REMPLACEZ 'admin@example.com' par l'email de votre compte admin !

Tapez (copiez-collez tout d'un coup) :

BEGIN;
DELETE FROM user_favorites WHERE user_id NOT IN (SELECT id FROM users WHERE email = 'VOTRE-EMAIL-ADMIN@example.com');
DELETE FROM user_agenda WHERE user_id NOT IN (SELECT id FROM users WHERE email = 'VOTRE-EMAIL-ADMIN@example.com');
DELETE FROM user_likes WHERE user_id NOT IN (SELECT id FROM users WHERE email = 'VOTRE-EMAIL-ADMIN@example.com');
DELETE FROM subscriptions WHERE user_id NOT IN (SELECT id FROM users WHERE email = 'VOTRE-EMAIL-ADMIN@example.com');
DELETE FROM user_passwords WHERE user_id NOT IN (SELECT id FROM users WHERE email = 'VOTRE-EMAIL-ADMIN@example.com');
DELETE FROM user_profiles WHERE user_id NOT IN (SELECT id FROM users WHERE email = 'VOTRE-EMAIL-ADMIN@example.com');
DELETE FROM users WHERE email != 'VOTRE-EMAIL-ADMIN@example.com';
COMMIT;

(Appuyez sur Entr√©e)


√âTAPE 6 : V√©rifier
------------------
Tapez :

SELECT email, username, role FROM users;

Vous devriez voir UN SEUL compte (votre admin) !


√âTAPE 7 : Quitter
-----------------
Tapez :

\q

(Appuyez sur Entr√©e)


============================================================
C'EST TOUT ! üöÄ
============================================================

